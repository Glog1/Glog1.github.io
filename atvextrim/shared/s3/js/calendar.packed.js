function f_tcalParseDate(e){var t=/^\s*(\d{1,2})\.(\d{1,2})\.(\d{2,4})\s*$/;if(!t.exec(e))return alert("Invalid date: '"+e+"'.\nAccepted format is mm/dd/yyyy.");var n=Number(RegExp.$1),r=Number(RegExp.$2),i=Number(RegExp.$3);if(i<100)i+=i<this.a_tpl.centyear?2e3:1900;if(r<1||r>12)return alert("Invalid month value: '"+r+"'.\nAllowed range is 01-12.");var s=new Date(i,r,0);if(n>s.getDate())return alert("Invalid day of month value: '"+n+"'.\nAllowed range for selected month is 01 - "+s.getDate()+".");return new Date(i,r-1,n)}function f_tcalGenerDate(e){return(e.getDate()<10?"0":"")+e.getDate()+"."+(e.getMonth()<9?"0":"")+(e.getMonth()+1)+"."+e.getFullYear()}function tcal(e,t){if(!t){if(e.lang&&e.lang=="ru"){t=RU_TCALDEF}else{t=A_TCALDEF}}if(!window.A_TCALS)window.A_TCALS=[];if(!window.A_TCALSIDX)window.A_TCALSIDX=[];this.s_id=e.id?e.id:A_TCALS.length;window.A_TCALS[this.s_id]=this;window.A_TCALSIDX[window.A_TCALSIDX.length]=this;this.f_show=f_tcalShow;this.f_hide=f_tcalHide;this.f_toggle=f_tcalToggle;this.f_update=f_tcalUpdate;this.f_relDate=f_tcalRelDate;this.f_parseDate=f_tcalParseDate;this.f_generDate=f_tcalGenerDate;this.s_iconId="tcalico_"+this.s_id;this.e_icon=f_getElement(this.s_iconId);if(!this.e_icon){var n=document.createElement("div");n.innerHTML='<img src="'+t.imgpath+'cal.gif" id="'+this.s_iconId+'" onclick="A_TCALS[\''+this.s_id+'\'].f_toggle()" class="tcalIcon" alt="'+t.open+'" />';e["place"].appendChild(n.firstChild);this.e_icon=f_getElement(this.s_iconId)}this.a_cfg=e;this.a_tpl=t}function f_tcalShow(e){if(!this.a_cfg.controlname)throw"TC: control name is not specified";if(this.a_cfg.formname){var t=document.forms[this.a_cfg.formname];if(!t)throw"TC: form '"+this.a_cfg.formname+"' can not be found";this.e_input=t.elements[this.a_cfg.controlname];if(this.a_cfg.intervalupdatecont&&this.a_cfg.intervalpair&&this.a_cfg.intervalpair.length==2){this.intervalpair=[t.elements[this.a_cfg.intervalpair[0]],t.elements[this.a_cfg.intervalpair[1]]];this.intervalupdatecont=t.elements[this.a_cfg.intervalupdatecont]}}else{this.e_input=f_getElement(this.a_cfg.controlname);if(this.a_cfg.intervalpair&&this.a_cfg.intervalpair.length==2){this.intervalpair=[f_getElement(this.a_cfg.intervalpair[0]),f_getElement(this.a_cfg.intervalpair[1])]}this.intervalupdatecont=f_getElement(this.a_cfg.intervalupdatecont)}if(!this.e_input||!this.e_input.tagName||this.e_input.tagName!="INPUT")throw"TC: element '"+this.a_cfg.controlname+"' does not exist in "+(this.a_cfg.formname?"form '"+this.a_cfg.controlname+"'":"this document");this.e_div=f_getElement("tcal");if(!this.e_div){this.e_div=document.createElement("DIV");this.e_div.id="tcal";document.body.appendChild(this.e_div)}this.e_iframe=f_getElement("tcalIF");if(b_ieFix&&!this.e_iframe){this.e_iframe=document.createElement("IFRAME");this.e_iframe.style.filter="alpha(opacity=0)";this.e_iframe.id="tcalIF";this.e_iframe.src=this.a_tpl.imgpath+"pixel.gif";document.body.appendChild(this.e_iframe)}f_tcalHideAll();this.e_icon=f_getElement(this.s_iconId);this.e_div.style.display="block";if(this.e_iframe){this.e_iframe.style.display="block"}if(!this.f_update())return;this.e_div.style.visibility="visible";this.e_div.style.display="block";if(this.e_iframe){this.e_iframe.style.visibility="visible";this.e_iframe.style.display="block"}this.e_icon.src=this.a_tpl.imgpath+"no_cal.gif";this.e_icon.title=this.a_tpl.close;this.b_visible=true}function f_tcalHide(e){if(e){this.e_input.value=this.f_generDate(new Date(e));if(this.intervalpair&&this.intervalupdatecont&&this.intervalpair[0].value!=""&&this.intervalpair[1].value!="")this.intervalupdatecont.value=this.intervalpair[0].value+" -- "+this.intervalpair[1].value;else if(this.intervalupdatecont)this.intervalupdatecont.value=""}if(!this.b_visible)return;if(this.e_iframe){this.e_iframe.style.visibility="hidden";this.e_iframe.style.display="none"}this.e_div.style.visibility="hidden";this.e_div.style.display="none";this.e_icon=f_getElement(this.s_iconId);this.e_icon.src=this.a_tpl.imgpath+"cal.gif";this.e_icon.title=window._s3Lang['JS_OPEN_CALENDAR'];this.b_visible=false}function f_tcalToggle(){return this.b_visible?this.f_hide():this.f_show()}function f_tcalUpdate(e){var t=new Date;t.setHours(0);t.setMinutes(0);t.setSeconds(0);t.setMilliseconds(0);var n=this.a_cfg.today?this.f_parseDate(this.a_cfg.today):t;var r=this.e_input.value==""?this.a_cfg.selected?this.f_parseDate(this.a_cfg.selected):n:this.f_parseDate(this.e_input.value);if(!e)e=r;else if(typeof e=="number")e=new Date(e);else if(typeof e=="string")this.f_parseDate(e);if(!e)return false;var i=new Date(e);i.setDate(1);i.setDate(1-(7+i.getDay()-this.a_tpl.weekstart)%7);var s,o='<table class="ctrl"><tbody><tr>'+(this.a_tpl.yearscroll?"<td"+this.f_relDate(e,-1,"y")+' title="Previous Year"><img src="'+this.a_tpl.imgpath+'prev_year.gif" /></td>':"")+"<td"+this.f_relDate(e,-1)+' title="Previous Month"><img src="'+this.a_tpl.imgpath+'prev_mon.gif" /></td><th>'+this.a_tpl.months[e.getMonth()]+" "+e.getFullYear()+"</th><td"+this.f_relDate(e,1)+' title="Next Month"><img src="'+this.a_tpl.imgpath+'next_mon.gif" /></td>'+(this.a_tpl.yearscroll?"<td"+this.f_relDate(e,1,"y")+' title="Next Year"><img src="'+this.a_tpl.imgpath+'next_year.gif" /></td></td>':"")+'</tr></tbody></table><table><tbody><tr class="wd">';for(var u=0;u<7;u++)o+="<th>"+this.a_tpl.weekdays[(this.a_tpl.weekstart+u)%7]+"</th>";o+="</tr>";var a=new Date(i);while(a.getMonth()==e.getMonth()||a.getMonth()==i.getMonth()){o+="<tr>";for(var f=0;f<7;f++){s=[];if(a.getMonth()!=e.getMonth())s[s.length]="othermonth";if(a.getDay()==0||a.getDay()==6)s[s.length]="weekend";if(a.valueOf()==n.valueOf())s[s.length]="today";if(a.valueOf()==r.valueOf())s[s.length]="selected";o+="<td onclick=\"A_TCALS['"+this.s_id+"'].f_hide("+a.valueOf()+')"'+(s.length?' class="'+s.join(" ")+'">':">")+a.getDate()+"</td>";a.setDate(a.getDate()+1)}o+="</tr>"}o+="</tbody></table>";this.e_div.innerHTML=o;var l=this.e_div.offsetWidth;var c=this.e_div.offsetHeight;var h=f_getPosition(this.e_icon,"Top")+this.e_icon.offsetHeight;var p=f_getPosition(this.e_icon,"Left")-l+this.e_icon.offsetWidth;if(p<0)p=0;this.e_div.style.left=p+"px";this.e_div.style.top=h+"px";if(this.e_iframe){this.e_iframe.style.left=p+"px";this.e_iframe.style.top=h+"px";this.e_iframe.style.width=l+6+"px";this.e_iframe.style.height=c+6+"px"}return true}function f_getPosition(e,t){var n=0,r,i=e;while(i){r=i["offset"+t];n+=r;i=i.offsetParent}if(b_ieMac)n+=parseInt(document.body[t.toLowerCase()+"Margin"]);else if(b_safari)n-=r;i=e;while(i!=document.body){r=i["scroll"+t];if(r&&i.style.overflow=="scroll")n-=r;i=i.parentNode}return n}function f_tcalRelDate(e,t,n){var n=n=="y"?"FullYear":"Month";var r=new Date(e);r["set"+n](e["get"+n]()+t);if(r.getDate()!=e.getDate())r.setDate(0);return" onclick=\"A_TCALS['"+this.s_id+"'].f_update("+r.valueOf()+')"'}function f_tcalHideAll(){for(var e=0;e<window.A_TCALSIDX.length;e++)window.A_TCALSIDX[e].f_hide()}var A_TCALDEF={months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Su","Mo","Tu","We","Th","Fr","Sa"],yearscroll:true,weekstart:0,centyear:70,imgpath:"/my/s3/images/calendar/",close:window._s3Lang['JS_CLOSE_CALENDAR'],open:window._s3Lang['JS_OPEN_CALENDAR']};var RU_TCALDEF={months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],weekdays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],yearscroll:true,weekstart:1,centyear:70,imgpath:"/my/s3/images/calendar/",close:"Закрыть календарь",open:"Открыть календарь"};f_getElement=document.all?function(e){return document.all[e]}:function(e){return document.getElementById(e)};var s_userAgent=navigator.userAgent.toLowerCase(),re_webkit=/WebKit\/(\d+)/i;var b_mac=s_userAgent.indexOf("mac")!=-1,b_ie5=s_userAgent.indexOf("msie 5")!=-1,b_ie6=s_userAgent.indexOf("msie 6")!=-1&&s_userAgent.indexOf("opera")==-1;var b_ieFix=b_ie5||b_ie6,b_ieMac=b_mac&&b_ie5,b_safari=b_mac&&re_webkit.exec(s_userAgent)&&Number(RegExp.$1)<500